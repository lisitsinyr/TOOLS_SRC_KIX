;=======================================================================================
; Logon.kix
;=======================================================================================
   BREAK ON

;=======================================================================================
; Uses
;=======================================================================================
   if not $KxlDir Call "\\fsgu\app\Tools\KxlDir.kxl" endif

   ; $KxlDir="I:\iis\TOOLS\ORIGINALS"

   Call $KxlDir+"\UDF\LUConst.kxl"
   Call $KxlDir+"\UDF\LURegistry.kxl"
   Call $KxlDir+"\Logon.kxl"
   Call $KxlDir+"\APPLinks.kxl"


;begin
   $Debug = 0
   ;------------------------------------------------------
   ; $LogDir, $Log, $LogFile
   ;------------------------------------------------------
   $Log = 30 
   if @LDomain = ""
      $LogDir = $LogPath+"\logon"
   else
      $LogDir = $LogPath+"\logon\"+@LDomain
   endif
   if not Exist($LogDir) MD $LogDir endif
   $s = AddCharR("_",$USERID,8)
   if UCase(@WKSTA) = UCase($TerminalServer)
      $LogFile = $s+"_T.log"
   else
      $LogFile = $s+"_L.log"
   endif
   $LogFile = LogFileName($Log,$LogDir,$LogFile)
   ;-----------------------------------------------------------
   ; srvcomment
   ;-----------------------------------------------------------
   $Key = "HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\lanmanserver\parameters"
   $srvcomment = RegReadString ($Key, "srvcomment")
   ; RegWriteString ($Key, "srvcomment", @ProductType+" "+$srvcomment)

   ;-----------------------------------------------------------
   ; Синхронизация времени
   ;-----------------------------------------------------------
   SyncTime
   ;-----------------------------------------------------------
   ; Удаление *.pwl файлов для W9x                                                                                                                         
   ;-----------------------------------------------------------
   DelPWL
   ;-----------------------------------------------------------
   ; Установка начальных настроек для Internet Explorer
   ;-----------------------------------------------------------
   SetIE
   ;-----------------------------------------------------------
   ; Установка Антивирусной программы
   ;-----------------------------------------------------------
   SetANTI
   ;-----------------------------------------------------------
   ; Подключение сетевых дисков
   ;-----------------------------------------------------------
   MapDrives
   ;-----------------------------------------------------------
   ; Выполнение персонального скрипта (если он есть)
   ;-----------------------------------------------------------
   ;MapDrivesPers
   ;-----------------------------------------------------------
   ; Выполнение скрипта для терминала
   ;-----------------------------------------------------------
   Terminal
   ;-----------------------------------------------------------
   ; CreateLinks
   ;-----------------------------------------------------------
   CreateLinks
   ;-----------------------------------------------------------
;end
